import{C as o,Da as r,k as a,ka as s,n as i,ta as l,za as g}from"./chunk-XZK7E5S4.js";var u=class n{constructor(t,e){this.http=t;this.router=e;this.loadFromStorage()}currentUserSignal=o(null);tokenSignal=o(null);currentUser=this.currentUserSignal.asReadonly();isAuthenticated=s(()=>!0);isAdmin=s(()=>!0);loadFromStorage=()=>{let t=localStorage.getItem("token"),e=localStorage.getItem("user");t&&e&&(this.tokenSignal.set(t),this.currentUserSignal.set(JSON.parse(e)))};getToken=()=>this.tokenSignal();login=(t,e)=>this.http.post(`${r.apiUrl}/auth/login`,{email:t,password:e});handleLoginSuccess=t=>{localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user)),this.tokenSignal.set(t.token),this.currentUserSignal.set(t.user)};logout=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),this.tokenSignal.set(null),this.currentUserSignal.set(null),this.router.navigate(["/login"])};refreshUser=()=>this.http.get(`${r.apiUrl}/auth/me`);changePassword=(t,e)=>this.http.post(`${r.apiUrl}/auth/change-password`,{currentPassword:t,newPassword:e});static \u0275fac=function(e){return new(e||n)(i(l),i(g))};static \u0275prov=a({token:n,factory:n.\u0275fac,providedIn:"root"})};export{u as a};
