import{a as q}from"./chunk-3S54QO74.js";import{a as L}from"./chunk-5NR4SW4X.js";import{a as J}from"./chunk-JFUHDB3I.js";import{a as H,b as W,e as G,k as X}from"./chunk-3PASNWI6.js";import{$ as V,Aa as U,C as b,Da as N,E as _,G as k,H as v,J as p,K as T,M as h,N as M,O as n,P as t,R as x,S as C,T as l,U as r,V as c,W as P,X as I,Z as R,_ as F,ba as z,da as y,fa as D,k as S,n as w,o as f,oa as $,p as E,ra as A,t as m,ta as j,u,xa as B,z as a}from"./chunk-XZK7E5S4.js";var O=class s{constructor(e){this.http=e}baseUrl=`${N.apiUrl}/discussions`;getByDrug=e=>this.http.get(`${this.baseUrl}/drug/${e}`);create=(e,i,o)=>this.http.post(this.baseUrl,{drug_id:e,content:i,parent_id:o});update=(e,i)=>this.http.patch(`${this.baseUrl}/${e}`,{content:i});delete=e=>this.http.delete(`${this.baseUrl}/${e}`);static \u0275fac=function(i){return new(i||s)(w(j))};static \u0275prov=S({token:s,factory:s.\u0275fac,providedIn:"root"})};var Y=(s,e)=>e.discussion.id,Z=(s,e)=>e.id;function ee(s,e){s&1&&(n(0,"div",0),r(1,"Loading..."),t())}function te(s,e){if(s&1&&(n(0,"span",10),r(1),t()),s&2){let i=l(2);a(),P("Schedule ",i.drug().dea_schedule,"")}}function ne(s,e){if(s&1&&(n(0,"span",28),r(1),t()),s&2){let i=l().$implicit;a(),I("",i.strength," ",i.unit,"")}}function ie(s,e){if(s&1&&(n(0,"li")(1,"span",27),r(2),t(),_(3,ne,2,2,"span",28),t()),s&2){let i=e.$implicit;a(2),c(i.name),a(),p(i.strength?3:-1)}}function oe(s,e){if(s&1&&(n(0,"section",14)(1,"h2"),r(2,"Active Ingredients"),t(),n(3,"ul",26),h(4,ie,4,2,"li",null,T),t()()),s&2){let i=l(2);a(4),M(i.drug().active_ingredients)}}function re(s,e){if(s&1){let i=x();n(0,"div",20),r(1," Replying to comment "),n(2,"button",29),C("click",function(){m(i);let d=l(2);return u(d.cancelReply())}),r(3,"Cancel"),t()()}}function se(s,e){if(s&1){let i=x();n(0,"button",29),C("click",function(){m(i);let d=l().$implicit,g=l(2);return u(g.deleteComment(d.discussion.id))}),r(1,"Delete"),t()}}function ae(s,e){if(s&1){let i=x();n(0,"button",29),C("click",function(){m(i);let d=l().$implicit,g=l(3);return u(g.deleteComment(d.id))}),r(1,"Delete"),t()}}function de(s,e){if(s&1&&(n(0,"div",34)(1,"div",31)(2,"strong"),r(3),t(),n(4,"span",32),r(5),y(6,"date"),t()(),n(7,"p"),r(8),t(),n(9,"div",33),_(10,ae,2,0,"button"),t()()),s&2){let i,o=e.$implicit,d=l(3);a(3),c(o.user_name),a(2),c(D(6,4,o.created_at,"short")),a(3),c(o.content),a(2),p(o.user_id===((i=d.authService.currentUser())==null?null:i.id)||d.authService.isAdmin()?10:-1)}}function ce(s,e){if(s&1){let i=x();n(0,"div",24)(1,"div",30)(2,"div",31)(3,"strong"),r(4),t(),n(5,"span",32),r(6),y(7,"date"),t()(),n(8,"p"),r(9),t(),n(10,"div",33)(11,"button",29),C("click",function(){let d=m(i).$implicit,g=l(2);return u(g.setReplyTo(d.discussion.id))}),r(12,"Reply"),t(),_(13,se,2,0,"button"),t()(),h(14,de,11,7,"div",34,Z),t()}if(s&2){let i,o=e.$implicit,d=l(2);a(4),c(o.discussion.user_name),a(2),c(D(7,4,o.discussion.created_at,"short")),a(3),c(o.discussion.content),a(4),p(o.discussion.user_id===((i=d.authService.currentUser())==null?null:i.id)||d.authService.isAdmin()?13:-1),a(),M(o.replies)}}function le(s,e){s&1&&(n(0,"p",25),r(1,"No discussions yet. Be the first to comment!"),t())}function ge(s,e){if(s&1){let i=x();n(0,"div",1)(1,"nav",3)(2,"a",4),r(3,"Drugs"),t(),n(4,"span"),r(5,"/"),t(),n(6,"span"),r(7),t()(),n(8,"div",5)(9,"div",6)(10,"h1"),r(11),t(),n(12,"button",7),C("click",function(){m(i);let d=l();return u(d.toggleRegistry())}),r(13),t()(),n(14,"div",8)(15,"span",9),r(16),t(),_(17,te,2,1,"span",10),n(18,"span",11),r(19),t()()(),n(20,"div",12)(21,"div",13)(22,"section",14)(23,"h2"),r(24,"Drug Information"),t(),n(25,"dl")(26,"div",15)(27,"dt"),r(28,"NDC"),t(),n(29,"dd",16),r(30),t()(),n(31,"div",15)(32,"dt"),r(33,"Generic Name"),t(),n(34,"dd"),r(35),t()(),n(36,"div",15)(37,"dt"),r(38,"Dosage Form"),t(),n(39,"dd"),r(40),t()(),n(41,"div",15)(42,"dt"),r(43,"Strength"),t(),n(44,"dd"),r(45),t()(),n(46,"div",15)(47,"dt"),r(48,"Route"),t(),n(49,"dd"),r(50),t()(),n(51,"div",15)(52,"dt"),r(53,"Manufacturer"),t(),n(54,"dd"),r(55),t()(),n(56,"div",15)(57,"dt"),r(58,"Marketing Status"),t(),n(59,"dd"),r(60),t()(),n(61,"div",15)(62,"dt"),r(63,"FDA Application Number"),t(),n(64,"dd"),r(65),t()(),n(66,"div",15)(67,"dt"),r(68,"Source"),t(),n(69,"dd"),r(70),t()()()(),_(71,oe,6,0,"section",14),t(),n(72,"div",17)(73,"section",18)(74,"h2"),r(75,"Team Discussion"),t(),n(76,"div",19),_(77,re,4,0,"div",20),n(78,"textarea",21),V("ngModelChange",function(d){m(i);let g=l();return F(g.newComment,d)||(g.newComment=d),u(d)}),t(),n(79,"button",22),C("click",function(){m(i);let d=l();return u(d.submitComment())}),r(80," Post Comment "),t()(),n(81,"div",23),h(82,ce,16,7,"div",24,Y,!1,le,2,0,"p",25),t()()()()()}if(s&2){let i,o=l();a(7),c(o.drug().name),a(4),c(o.drug().name),a(),v("in-registry",o.inRegistry()),a(),P(" ",o.inRegistry()?"\u2605 In Registry":"\u2606 Add to Registry"," "),a(2),v("rx",o.drug().rx_otc==="RX")("otc",o.drug().rx_otc==="OTC"),a(),P(" ",o.drug().rx_otc," "),a(),p(o.drug().dea_schedule?17:-1),a(2),c(o.drug().species),a(11),c(o.drug().ndc),a(5),c(o.drug().generic_name||"-"),a(5),c(o.drug().dosage_form||"-"),a(5),c(o.drug().strength||"-"),a(5),c(o.drug().route||"-"),a(5),c(o.drug().manufacturer||"-"),a(5),c(o.drug().marketing_status||"-"),a(5),c(o.drug().fda_application_number||"-"),a(5),c(o.drug().source),a(),p((i=o.drug().active_ingredients)!=null&&i.length?71:-1),a(6),p(o.replyTo?77:-1),a(),R("ngModel",o.newComment),a(),k("disabled",!o.newComment.trim()),a(3),M(o.getThreadedDiscussions())}}function me(s,e){s&1&&(n(0,"div",2),r(1,"Drug not found"),t())}var K=class s{route=f(B);drugsService=f(q);discussionsService=f(O);registryService=f(J);authService=f(L);drug=b(null);discussions=b([]);loading=b(!0);inRegistry=b(!1);newComment="";replyTo=null;ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&(this.loadDrug(e),this.loadDiscussions(e),this.checkRegistry(e))}checkRegistry=e=>{this.registryService.checkRegistry(e).subscribe({next:i=>{this.inRegistry.set(i.inRegistry)}})};toggleRegistry=()=>{let e=this.drug();e&&(this.inRegistry()?this.registryService.removeFromRegistry(e.id).subscribe({next:()=>{this.inRegistry.set(!1)}}):this.registryService.addToRegistry(e.id).subscribe({next:()=>{this.inRegistry.set(!0)}}))};loadDrug=e=>{this.drugsService.getById(e).subscribe({next:i=>{this.drug.set(i),this.loading.set(!1)},error:()=>{this.loading.set(!1)}})};loadDiscussions=e=>{this.discussionsService.getByDrug(e).subscribe({next:i=>{this.discussions.set(i)}})};submitComment=()=>{let e=this.drug();!e||!this.newComment.trim()||this.discussionsService.create(e.id,this.newComment.trim(),this.replyTo||void 0).subscribe({next:()=>{this.newComment="",this.replyTo=null,this.loadDiscussions(e.id)}})};setReplyTo=e=>{this.replyTo=e};cancelReply=()=>{this.replyTo=null};deleteComment=e=>{let i=this.drug();i&&confirm("Are you sure you want to delete this comment?")&&this.discussionsService.delete(e).subscribe({next:()=>{this.loadDiscussions(i.id)}})};getThreadedDiscussions=()=>{let e=this.discussions();return e.filter(o=>!o.parent_id).map(o=>({discussion:o,replies:e.filter(d=>d.parent_id===o.id)}))};static \u0275fac=function(i){return new(i||s)};static \u0275cmp=E({type:s,selectors:[["app-drug-detail"]],standalone:!0,features:[z],decls:3,vars:1,consts:[[1,"loading"],[1,"drug-detail-page"],[1,"not-found"],[1,"breadcrumb"],["routerLink","/drugs"],[1,"drug-header"],[1,"header-main"],[1,"registry-btn",3,"click"],[1,"badges"],[1,"badge"],[1,"badge","dea"],[1,"badge","species"],[1,"content-grid"],[1,"main-content"],[1,"info-card"],[1,"info-row"],[1,"ndc"],[1,"sidebar"],[1,"discussions-card"],[1,"new-comment"],[1,"replying-to"],["placeholder","Add a comment...","rows","3",3,"ngModelChange","ngModel"],[3,"click","disabled"],[1,"discussions-list"],[1,"discussion-thread"],[1,"no-discussions"],[1,"ingredients-list"],[1,"ing-name"],[1,"ing-strength"],[3,"click"],[1,"discussion"],[1,"discussion-header"],[1,"date"],[1,"discussion-actions"],[1,"discussion","reply"]],template:function(i,o){i&1&&_(0,ee,2,0,"div",0)(1,ge,85,26,"div",1)(2,me,2,0,"div",2),i&2&&p(o.loading()?0:o.drug()?1:2)},dependencies:[A,$,X,H,W,G,U],styles:[".loading[_ngcontent-%COMP%], .not-found[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#6b7280}.drug-detail-page[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto}.breadcrumb[_ngcontent-%COMP%]{margin-bottom:1rem;color:#6b7280;font-size:.875rem}.breadcrumb[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#4f46e5;text-decoration:none}.breadcrumb[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.breadcrumb[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:0 .5rem}.drug-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.drug-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:1rem;margin-bottom:.75rem}.drug-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.75rem;color:#1a1a2e}.drug-header[_ngcontent-%COMP%]   .registry-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.875rem;background:#f3f4f6;color:#374151;border:1px solid #d1d5db;border-radius:6px;cursor:pointer;white-space:nowrap;transition:all .15s}.drug-header[_ngcontent-%COMP%]   .registry-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb;border-color:#9ca3af}.drug-header[_ngcontent-%COMP%]   .registry-btn.in-registry[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e;border-color:#f59e0b}.drug-header[_ngcontent-%COMP%]   .registry-btn.in-registry[_ngcontent-%COMP%]:hover{background:#fde68a}.drug-header[_ngcontent-%COMP%]   .badges[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap}.badge[_ngcontent-%COMP%]{display:inline-block;padding:.25rem .75rem;border-radius:4px;font-size:.75rem;font-weight:600}.badge.rx[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.badge.otc[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.badge.dea[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.badge.species[_ngcontent-%COMP%]{background:#f3e8ff;color:#7c3aed}.content-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 400px;gap:1.5rem}@media (max-width: 1024px){.content-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.info-card[_ngcontent-%COMP%], .discussions-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:1.5rem;box-shadow:0 1px 3px #0000001a;margin-bottom:1.5rem}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .discussions-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.125rem;color:#1a1a2e}dl[_ngcontent-%COMP%]{margin:0}.info-row[_ngcontent-%COMP%]{display:flex;padding:.5rem 0;border-bottom:1px solid #f3f4f6}.info-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.info-row[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{width:180px;color:#6b7280;font-size:.875rem;flex-shrink:0}.info-row[_ngcontent-%COMP%]   dd[_ngcontent-%COMP%]{margin:0;color:#1a1a2e;font-size:.875rem}.info-row[_ngcontent-%COMP%]   dd.ndc[_ngcontent-%COMP%]{font-family:monospace}.ingredients-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.ingredients-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem 0;border-bottom:1px solid #f3f4f6}.ingredients-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{border-bottom:none}.ingredients-list[_ngcontent-%COMP%]   .ing-name[_ngcontent-%COMP%]{color:#1a1a2e}.ingredients-list[_ngcontent-%COMP%]   .ing-strength[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem}.new-comment[_ngcontent-%COMP%]{margin-bottom:1.5rem}.new-comment[_ngcontent-%COMP%]   .replying-to[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.5rem;background:#f3f4f6;border-radius:4px;margin-bottom:.5rem;font-size:.875rem;color:#6b7280}.new-comment[_ngcontent-%COMP%]   .replying-to[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:#4f46e5;cursor:pointer;font-size:.75rem}.new-comment[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #d1d5db;border-radius:6px;resize:vertical;font-family:inherit;box-sizing:border-box}.new-comment[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#4f46e5}.new-comment[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:.5rem;padding:.5rem 1rem;background:#4f46e5;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:.875rem}.new-comment[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:#4338ca}.new-comment[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.discussions-list[_ngcontent-%COMP%]   .discussion-thread[_ngcontent-%COMP%]{margin-bottom:1rem}.discussions-list[_ngcontent-%COMP%]   .discussion[_ngcontent-%COMP%]{padding:.75rem;background:#f9fafb;border-radius:6px;margin-bottom:.5rem}.discussions-list[_ngcontent-%COMP%]   .discussion.reply[_ngcontent-%COMP%]{margin-left:1.5rem;background:#f3f4f6}.discussions-list[_ngcontent-%COMP%]   .discussion[_ngcontent-%COMP%]   .discussion-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:.5rem;font-size:.875rem}.discussions-list[_ngcontent-%COMP%]   .discussion[_ngcontent-%COMP%]   .discussion-header[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#1a1a2e}.discussions-list[_ngcontent-%COMP%]   .discussion[_ngcontent-%COMP%]   .discussion-header[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{color:#9ca3af;font-size:.75rem}.discussions-list[_ngcontent-%COMP%]   .discussion[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:.875rem;color:#374151}.discussions-list[_ngcontent-%COMP%]   .discussion[_ngcontent-%COMP%]   .discussion-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:#6b7280;cursor:pointer;font-size:.75rem;padding:0;margin-right:1rem}.discussions-list[_ngcontent-%COMP%]   .discussion[_ngcontent-%COMP%]   .discussion-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#4f46e5}.discussions-list[_ngcontent-%COMP%]   .no-discussions[_ngcontent-%COMP%]{text-align:center;color:#9ca3af;padding:1rem;font-size:.875rem}@media (max-width: 768px){.drug-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.drug-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.drug-header[_ngcontent-%COMP%]   .registry-btn[_ngcontent-%COMP%]{align-self:flex-start}.info-card[_ngcontent-%COMP%], .discussions-card[_ngcontent-%COMP%]{padding:1rem}.info-row[_ngcontent-%COMP%]{flex-direction:column;gap:.25rem}.info-row[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{width:auto;font-weight:500}.discussions-list[_ngcontent-%COMP%]   .discussion.reply[_ngcontent-%COMP%]{margin-left:.75rem}}"]})};export{K as DrugDetailComponent};
