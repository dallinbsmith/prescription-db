import{a as Q}from"./chunk-3S54QO74.js";import{a as Y}from"./chunk-JFUHDB3I.js";import{a as X,b as $,e as G,g as U,h as q,i as J,k as K}from"./chunk-3PASNWI6.js";import{$ as M,Aa as H,C as h,E as O,G as d,H as E,J as y,K as F,L as S,M as C,N as f,O as o,P as i,Q as V,R as T,S as p,T as g,U as l,V as m,W as b,Y as N,Z as P,_ as x,a as k,b as L,ba as R,ca as B,da as v,ea as w,ka as D,na as W,o as I,p as z,qa as A,ra as j,t as u,u as _,z as a}from"./chunk-XZK7E5S4.js";var te=(r,t)=>t.id,ne=r=>["/drugs",r];function ie(r,t){if(r&1&&(o(0,"option",8),l(1),i()),r&2){let e=t.$implicit;d("value",e),a(),m(e)}}function re(r,t){if(r&1&&(o(0,"option",8),l(1),i()),r&2){let e=t.$implicit;d("value",e),a(),m(e==="NONE"?"Non-Controlled":"Schedule "+e)}}function oe(r,t){if(r&1&&(o(0,"option",8),l(1),i()),r&2){let e=t.$implicit;d("value",e),a(),m(e)}}function ae(r,t){if(r&1&&(o(0,"span",17),l(1),i()),r&2){let e=g().$implicit,n=g();d("ngClass",n.getDeaClass(e.dea_schedule)),a(),b(" ",e.dea_schedule," ")}}function le(r,t){r&1&&l(0," - ")}function se(r,t){if(r&1){let e=T();o(0,"tr",12)(1,"td",14),l(2),i(),o(3,"td"),l(4),i(),o(5,"td",15),l(6),i(),o(7,"td"),l(8),i(),o(9,"td"),l(10),i(),o(11,"td")(12,"span",16),l(13),i()(),o(14,"td"),O(15,ae,2,2,"span",17)(16,le,1,0),i(),o(17,"td"),l(18),i(),o(19,"td",18)(20,"button",19),p("click",function(s){let c=u(e).$implicit,ee=g();return _(ee.toggleRegistry(c,s))}),l(21),i()()()}if(r&2){let e=t.$implicit,n=g();d("routerLink",B(17,ne,e.id)),a(2),m(e.name),a(2),m(e.generic_name||"-"),a(2),m(e.ndc),a(2),m(e.dosage_form||"-"),a(2),m(e.manufacturer||"-"),a(2),E("rx",e.rx_otc==="RX")("otc",e.rx_otc==="OTC"),a(),b(" ",e.rx_otc," "),a(2),y(e.dea_schedule?15:16),a(3),m(e.species),a(2),E("in-registry",n.isInRegistry(e.id)),d("title",n.isInRegistry(e.id)?"Remove from Registry":"Add to Registry"),a(),b(" ",n.isInRegistry(e.id)?"\u2605":"\u2606"," ")}}function ce(r,t){r&1&&l(0," Loading... ")}function de(r,t){r&1&&l(0," No drugs found ")}function ge(r,t){if(r&1&&(o(0,"tr")(1,"td",20),O(2,ce,1,0)(3,de,1,0),i()()),r&2){let e=g();a(2),y(e.loading()?2:3)}}function pe(r,t){r&1&&(o(0,"span",27),l(1,"..."),i())}function me(r,t){if(r&1){let e=T();o(0,"button",23),p("click",function(){u(e);let s=g().$implicit,c=g(2);return _(c.goToPage(s))}),l(1),i()}if(r&2){let e=g().$implicit,n=g(2);E("active",e===n.currentPage()),d("disabled",n.loading()),a(),b(" ",e," ")}}function ue(r,t){if(r&1&&O(0,pe,2,0,"span",27)(1,me,2,4,"button",28),r&2){let e=t.$implicit;y(e==="..."?0:1)}}function _e(r,t){if(r&1&&(o(0,"option",26),l(1),i()),r&2){let e=t.$implicit;d("ngValue",e),a(),m(e)}}function Ce(r,t){if(r&1){let e=T();o(0,"div",13)(1,"div",21),l(2),v(3,"number"),v(4,"number"),v(5,"number"),i(),o(6,"div",22)(7,"button",23),p("click",function(){u(e);let s=g();return _(s.previousPage())}),l(8," Previous "),i(),C(9,ue,2,1,null,null,F),o(11,"button",23),p("click",function(){u(e);let s=g();return _(s.nextPage())}),l(12," Next "),i()(),o(13,"div",24)(14,"label"),l(15,"Per page:"),i(),o(16,"select",25),M("ngModelChange",function(s){u(e);let c=g();return x(c.pageSize,s)||(c.pageSize=s),_(s)}),p("ngModelChange",function(){u(e);let s=g();return _(s.onPageSizeChange())}),C(17,_e,2,2,"option",26,S),i()()()}if(r&2){let e=g();a(2),N(" Showing ",w(3,6,e.startIndex()),"-",w(4,8,e.endIndex())," of ",w(5,10,e.total())," "),a(5),d("disabled",e.currentPage()===1||e.loading()),a(2),f(e.visiblePages()),a(2),d("disabled",e.currentPage()===e.totalPages()||e.loading()),a(5),P("ngModel",e.pageSize),a(),f(e.pageSizeOptions)}}var Z=class r{drugsService=I(Q);registryService=I(Y);drugs=h([]);total=h(0);loading=h(!1);registryDrugIds=h(new Set);searchTerm="";currentPage=h(1);pageSize=50;pageSizeOptions=[25,50,100,200];filters={};rxOtcOptions=["RX","OTC","BOTH"];deaScheduleOptions=["NONE","I","II","III","IV","V"];speciesOptions=["HUMAN","ANIMAL","BOTH"];totalPages=D(()=>Math.ceil(this.total()/this.pageSize)||1);startIndex=D(()=>(this.currentPage()-1)*this.pageSize+1);endIndex=D(()=>Math.min(this.currentPage()*this.pageSize,this.total()));visiblePages=D(()=>{let t=this.totalPages(),e=this.currentPage(),n=[];if(t<=7)for(let s=1;s<=t;s++)n.push(s);else{n.push(1),e>3&&n.push("...");for(let s=Math.max(2,e-1);s<=Math.min(t-1,e+1);s++)n.push(s);e<t-2&&n.push("..."),n.push(t)}return n});ngOnInit(){this.loadPage(),this.loadRegistryIds()}loadRegistryIds=()=>{this.registryService.getRegistry().subscribe({next:t=>{this.registryDrugIds.set(new Set(t.map(e=>e.drug_id)))}})};isInRegistry=t=>this.registryDrugIds().has(t);toggleRegistry=(t,e)=>{e.stopPropagation(),e.preventDefault(),this.isInRegistry(t.id)?this.registryService.removeFromRegistry(t.id).subscribe({next:()=>{this.registryDrugIds.update(n=>{let s=new Set(n);return s.delete(t.id),s})}}):this.registryService.addToRegistry(t.id).subscribe({next:()=>{this.registryDrugIds.update(n=>{let s=new Set(n);return s.add(t.id),s})}})};loadPage=()=>{this.loading.set(!0);let t=L(k({},this.filters),{search:this.searchTerm||void 0,limit:this.pageSize,offset:(this.currentPage()-1)*this.pageSize});this.drugsService.search(t).subscribe({next:e=>{this.drugs.set(e.drugs),this.total.set(e.total),this.loading.set(!1)},error:()=>{this.loading.set(!1)}})};search=()=>{this.currentPage.set(1),this.loadPage()};goToPage=t=>{typeof t=="number"&&(t<1||t>this.totalPages()||(this.currentPage.set(t),this.loadPage()))};previousPage=()=>{this.currentPage()>1&&(this.currentPage.update(t=>t-1),this.loadPage())};nextPage=()=>{this.currentPage()<this.totalPages()&&(this.currentPage.update(t=>t+1),this.loadPage())};onPageSizeChange=()=>{this.currentPage.set(1),this.loadPage()};onFilterChange=()=>{this.search()};clearFilters=()=>{this.searchTerm="",this.filters={},this.currentPage.set(1),this.loadPage()};getDeaClass=t=>t?`dea-${t.toLowerCase()}`:"";static \u0275fac=function(e){return new(e||r)};static \u0275cmp=z({type:r,selectors:[["app-drug-list"]],standalone:!0,features:[R],decls:56,vars:13,consts:[[1,"drug-list-page"],[1,"page-header"],[1,"search-section"],[1,"search-bar"],["type","text","placeholder","Search by name, NDC, or manufacturer...",3,"ngModelChange","keyup.enter","ngModel"],[3,"click","disabled"],[1,"filters"],[3,"ngModelChange","change","ngModel"],[3,"value"],[1,"clear-btn",3,"click"],[1,"drug-table"],[1,"action-col"],[3,"routerLink"],[1,"pagination"],[1,"drug-name"],[1,"ndc"],[1,"badge"],[1,"badge","dea",3,"ngClass"],[1,"action-cell"],[1,"registry-btn",3,"click","title"],["colspan","9",1,"empty"],[1,"pagination-info"],[1,"pagination-controls"],[1,"page-btn",3,"click","disabled"],[1,"page-size"],[3,"ngModelChange","ngModel"],[3,"ngValue"],[1,"ellipsis"],[1,"page-btn",3,"active","disabled"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"header",1)(2,"h1"),l(3,"Drug Database"),i(),o(4,"p"),l(5),v(6,"number"),i()(),o(7,"div",2)(8,"div",3)(9,"input",4),M("ngModelChange",function(c){return x(n.searchTerm,c)||(n.searchTerm=c),c}),p("keyup.enter",function(){return n.search()}),i(),o(10,"button",5),p("click",function(){return n.search()}),l(11,"Search"),i()(),o(12,"div",6)(13,"select",7),M("ngModelChange",function(c){return x(n.filters.rx_otc,c)||(n.filters.rx_otc=c),c}),p("change",function(){return n.onFilterChange()}),o(14,"option",8),l(15,"All Types"),i(),C(16,ie,2,2,"option",8,S),i(),o(18,"select",7),M("ngModelChange",function(c){return x(n.filters.dea_schedule,c)||(n.filters.dea_schedule=c),c}),p("change",function(){return n.onFilterChange()}),o(19,"option",8),l(20,"All DEA Schedules"),i(),C(21,re,2,2,"option",8,S),i(),o(23,"select",7),M("ngModelChange",function(c){return x(n.filters.species,c)||(n.filters.species=c),c}),p("change",function(){return n.onFilterChange()}),o(24,"option",8),l(25,"All Species"),i(),C(26,oe,2,2,"option",8,S),i(),o(28,"button",9),p("click",function(){return n.clearFilters()}),l(29,"Clear Filters"),i()()(),o(30,"div",10)(31,"table")(32,"thead")(33,"tr")(34,"th"),l(35,"Name"),i(),o(36,"th"),l(37,"Generic Name"),i(),o(38,"th"),l(39,"NDC"),i(),o(40,"th"),l(41,"Form"),i(),o(42,"th"),l(43,"Manufacturer"),i(),o(44,"th"),l(45,"Type"),i(),o(46,"th"),l(47,"DEA"),i(),o(48,"th"),l(49,"Species"),i(),V(50,"th",11),i()(),o(51,"tbody"),C(52,se,22,19,"tr",12,te,!1,ge,4,1,"tr"),i()()(),O(55,Ce,19,12,"div",13),i()),e&2&&(a(5),b("",w(6,11,n.total())," drugs found"),a(4),P("ngModel",n.searchTerm),a(),d("disabled",n.loading()),a(3),P("ngModel",n.filters.rx_otc),a(),d("value",void 0),a(2),f(n.rxOtcOptions),a(2),P("ngModel",n.filters.dea_schedule),a(),d("value",void 0),a(2),f(n.deaScheduleOptions),a(2),P("ngModel",n.filters.species),a(),d("value",void 0),a(2),f(n.speciesOptions),a(26),f(n.drugs()),a(3),y(n.total()>0?55:-1))},dependencies:[j,W,A,K,q,J,X,U,$,G,H],styles:[".drug-list-page[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto}.page-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.75rem;color:#1a1a2e}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0 0;color:#6b7280}.search-section[_ngcontent-%COMP%]{background:#fff;padding:1.5rem;border-radius:8px;margin-bottom:1.5rem;box-shadow:0 1px 3px #0000001a}.search-bar[_ngcontent-%COMP%]{display:flex;gap:.75rem;margin-bottom:1rem}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:.75rem 1rem;border:1px solid #d1d5db;border-radius:6px;font-size:1rem}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#4f46e5}.search-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:#4f46e5;color:#fff;border:none;border-radius:6px;cursor:pointer;font-weight:500}.search-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:#4338ca}.search-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.6}.filters[_ngcontent-%COMP%]{display:flex;gap:.75rem;flex-wrap:wrap}.filters[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid #d1d5db;border-radius:6px;background:#fff;font-size:.875rem;min-width:150px}.filters[_ngcontent-%COMP%]   .clear-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;background:#f3f4f6;border:1px solid #d1d5db;border-radius:6px;cursor:pointer;font-size:.875rem}.filters[_ngcontent-%COMP%]   .clear-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb}.drug-table[_ngcontent-%COMP%]{background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 1px 3px #0000001a}.drug-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.drug-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .drug-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;text-align:left;border-bottom:1px solid #e5e7eb}.drug-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f9fafb;font-weight:600;color:#374151;font-size:.875rem}.drug-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{cursor:pointer;transition:background .15s}.drug-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f9fafb}.drug-table[_ngcontent-%COMP%]   .drug-name[_ngcontent-%COMP%]{font-weight:500;color:#1a1a2e}.drug-table[_ngcontent-%COMP%]   .ndc[_ngcontent-%COMP%]{font-family:monospace;font-size:.875rem}.drug-table[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{text-align:center;color:#6b7280;padding:2rem}.drug-table[_ngcontent-%COMP%]   .action-col[_ngcontent-%COMP%]{width:50px}.drug-table[_ngcontent-%COMP%]   .action-cell[_ngcontent-%COMP%]{text-align:center}.registry-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.25rem;cursor:pointer;color:#d1d5db;padding:.25rem;line-height:1;transition:color .15s,transform .15s}.registry-btn[_ngcontent-%COMP%]:hover{color:#f59e0b;transform:scale(1.2)}.registry-btn.in-registry[_ngcontent-%COMP%]{color:#f59e0b}.badge[_ngcontent-%COMP%]{display:inline-block;padding:.25rem .5rem;border-radius:4px;font-size:.75rem;font-weight:600}.badge.rx[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.badge.otc[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.badge.dea[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.badge.dea.dea-i[_ngcontent-%COMP%], .badge.dea.dea-ii[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.pagination[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.5rem;background:#fff;border-radius:8px;margin-top:1rem;box-shadow:0 1px 3px #0000001a;flex-wrap:wrap;gap:1rem}.pagination-info[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem}.pagination-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.page-btn[_ngcontent-%COMP%]{padding:.5rem .75rem;background:#fff;border:1px solid #d1d5db;border-radius:6px;cursor:pointer;font-size:.875rem;min-width:2.5rem;transition:all .15s}.page-btn[_ngcontent-%COMP%]:hover:not(:disabled):not(.active){background:#f3f4f6;border-color:#9ca3af}.page-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.page-btn.active[_ngcontent-%COMP%]{background:#4f46e5;border-color:#4f46e5;color:#fff}.ellipsis[_ngcontent-%COMP%]{padding:.5rem .25rem;color:#6b7280}.page-size[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.page-size[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem}.page-size[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem .75rem;border:1px solid #d1d5db;border-radius:6px;background:#fff;font-size:.875rem}@media (max-width: 1024px){.drug-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .drug-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem .75rem;font-size:.875rem}}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.search-section[_ngcontent-%COMP%]{padding:1rem}.search-bar[_ngcontent-%COMP%]{flex-direction:column}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .search-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.filters[_ngcontent-%COMP%]{flex-direction:column}.filters[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;min-width:auto}.filters[_ngcontent-%COMP%]   .clear-btn[_ngcontent-%COMP%]{width:100%}.drug-table[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}.drug-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{min-width:700px}.drug-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .drug-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem;font-size:.8rem;white-space:nowrap}.pagination[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;padding:1rem}.pagination[_ngcontent-%COMP%]   .pagination-info[_ngcontent-%COMP%]{text-align:center}.pagination[_ngcontent-%COMP%]   .pagination-controls[_ngcontent-%COMP%]{justify-content:center;flex-wrap:wrap}.pagination[_ngcontent-%COMP%]   .page-size[_ngcontent-%COMP%]{justify-content:center}.page-btn[_ngcontent-%COMP%]{padding:.4rem .6rem;min-width:2rem;font-size:.8rem}}"]})};export{Z as DrugListComponent};
