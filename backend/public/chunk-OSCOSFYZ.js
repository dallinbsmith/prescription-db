import{a as A}from"./chunk-JFUHDB3I.js";import{a as D,b as N,e as $,k as j}from"./chunk-3PASNWI6.js";import{$ as T,A as E,Aa as L,C as u,E as g,G as h,H as S,J as m,M as y,N as M,O as t,P as n,R as P,S as x,T as c,U as r,V as s,W as f,X as w,Z as k,_ as R,ba as F,ca as I,ka as V,p as O,ra as z,t as p,u as C,y as v,z as a}from"./chunk-XZK7E5S4.js";var B=(i,o)=>o.id,G=i=>["/drugs",i];function U(i,o){i&1&&(t(0,"div",3),r(1,"Loading registry..."),n())}function X(i,o){i&1&&(t(0,"p"),r(1,"No drugs match your search."),n())}function Y(i,o){i&1&&(t(0,"p"),r(1,"Your registry is empty."),n(),t(2,"p"),r(3,"Add drugs from the "),t(4,"a",6),r(5,"Drugs"),n(),r(6," page to track them here."),n())}function q(i,o){if(i&1&&(t(0,"div",4),g(1,X,2,0,"p")(2,Y,7,0),n()),i&2){let e=c();a(),m(e.searchTerm?1:2)}}function H(i,o){if(i&1&&(t(0,"span",13),r(1),n()),i&2){let e=c().$implicit;a(),s(e.drug.dea_schedule)}}function J(i,o){if(i&1){let e=P();t(0,"tr",9)(1,"td",11),r(2),n(),t(3,"td"),r(4),n(),t(5,"td"),r(6),n(),t(7,"td"),r(8),n(),t(9,"td"),r(10),n(),t(11,"td")(12,"span",12),r(13),n(),g(14,H,2,1,"span",13),n(),t(15,"td",14)(16,"button",15),x("click",function(d){let _=p(e).$implicit,b=c(2);return C(b.openCompetitorsModal(_,d))}),r(17," Competitors "),n(),t(18,"button",16),x("click",function(d){let _=p(e).$implicit,b=c(2);return C(b.removeFromRegistry(_,d))}),r(19," Remove "),n()()()}if(i&2){let e=o.$implicit;h("routerLink",I(12,G,e.drug_id)),a(2),s(e.drug.name),a(2),s(e.drug.generic_name||"-"),a(2),s(e.drug.dosage_form||"-"),a(2),s(e.drug.strength||"-"),a(2),s(e.drug.manufacturer||"-"),a(2),S("rx",e.drug.rx_otc==="RX")("otc",e.drug.rx_otc==="OTC"),a(),f(" ",e.drug.rx_otc," "),a(),m(e.drug.dea_schedule?14:-1)}}function K(i,o){if(i&1&&(t(0,"div",7)(1,"table",8)(2,"thead")(3,"tr")(4,"th"),r(5,"Name"),n(),t(6,"th"),r(7,"Generic Name"),n(),t(8,"th"),r(9,"Form"),n(),t(10,"th"),r(11,"Strength"),n(),t(12,"th"),r(13,"Manufacturer"),n(),t(14,"th"),r(15,"Type"),n(),t(16,"th"),r(17,"Actions"),n()()(),t(18,"tbody"),y(19,J,20,14,"tr",9,B),n()()(),t(21,"div",10),r(22),n()),i&2){let e=c();a(19),M(e.filteredEntries()),a(3),w(" Showing ",e.filteredEntries().length," of ",e.entries().length," drugs in registry ")}}function Q(i,o){if(i&1&&(t(0,"span",25),r(1),n()),i&2){let e=c(3);a(),f("(",e.selectedEntry().drug.generic_name,")")}}function Z(i,o){if(i&1&&(t(0,"div",21)(1,"strong"),r(2),n(),g(3,Q,2,1,"span",25),n()),i&2){let e=c(2);a(2),s(e.selectedEntry().drug.name),a(),m(e.selectedEntry().drug.generic_name?3:-1)}}function ee(i,o){i&1&&(t(0,"div",3),r(1,"Loading competitors..."),n())}function te(i,o){i&1&&(t(0,"div",4)(1,"p"),r(2,"No competitors currently carry this drug."),n()())}function ne(i,o){if(i&1&&(t(0,"a",29),r(1,"View"),n()),i&2){let e=c().$implicit;h("href",e.url,v)}}function ie(i,o){i&1&&r(0," - ")}function oe(i,o){if(i&1&&(t(0,"tr")(1,"td",28),r(2),n(),t(3,"td"),r(4),n(),t(5,"td"),r(6),n(),t(7,"td"),r(8),n(),t(9,"td"),g(10,ne,2,1,"a",29)(11,ie,1,0),n()()),i&2){let e=o.$implicit,l=c(3);a(2),s(e.competitor),a(2),s(e.external_name),a(2),s(l.formatPrice(e.price)),a(2),s(e.category||"-"),a(2),m(e.url?10:11)}}function re(i,o){if(i&1&&(t(0,"table",26)(1,"thead")(2,"tr")(3,"th"),r(4,"Competitor"),n(),t(5,"th"),r(6,"Listed Name"),n(),t(7,"th"),r(8,"Price"),n(),t(9,"th"),r(10,"Category"),n(),t(11,"th"),r(12,"Link"),n()()(),t(13,"tbody"),y(14,oe,12,5,"tr",null,B),n()(),t(16,"div",27),r(17),n()),i&2){let e=c(2);a(14),M(e.competitors()),a(3),f(" ",e.competitors().length," competitor(s) carry this drug ")}}function ae(i,o){if(i&1){let e=P();t(0,"div",17),x("click",function(){p(e);let d=c();return C(d.closeCompetitorsModal())}),t(1,"div",18),x("click",function(d){return p(e),C(d.stopPropagation())}),t(2,"div",19)(3,"h2"),r(4,"Competitors Carrying This Drug"),n(),t(5,"button",20),x("click",function(){p(e);let d=c();return C(d.closeCompetitorsModal())}),r(6,"\xD7"),n()(),g(7,Z,4,2,"div",21),t(8,"div",22),g(9,ee,2,0,"div",3)(10,te,3,0,"div",4)(11,re,18,1),n(),t(12,"div",23)(13,"button",24),x("click",function(){p(e);let d=c();return C(d.closeCompetitorsModal())}),r(14,"Close"),n()()()()}if(i&2){let e=c();a(7),m(e.selectedEntry()?7:-1),a(2),m(e.loadingCompetitors()?9:e.competitors().length===0?10:11)}}var W=class i{registryService;entries=u([]);loading=u(!1);searchTerm="";showCompetitorsModal=u(!1);selectedEntry=u(null);competitors=u([]);loadingCompetitors=u(!1);filteredEntries=V(()=>{let o=this.searchTerm.toLowerCase().trim();return o?this.entries().filter(e=>{let l=e.drug;return l.name?.toLowerCase().includes(o)||l.generic_name?.toLowerCase().includes(o)||l.manufacturer?.toLowerCase().includes(o)||l.ndc?.toLowerCase().includes(o)}):this.entries()});constructor(o){this.registryService=o}ngOnInit=()=>{this.loadRegistry()};loadRegistry=()=>{this.loading.set(!0),this.registryService.getRegistry().subscribe({next:o=>{this.entries.set(o),this.loading.set(!1)},error:o=>{console.error("Failed to load registry",o),this.loading.set(!1)}})};removeFromRegistry=(o,e)=>{e.stopPropagation(),confirm(`Remove "${o.drug.name}" from registry?`)&&this.registryService.removeFromRegistry(o.drug_id).subscribe({next:()=>{this.entries.update(l=>l.filter(d=>d.id!==o.id))},error:l=>{console.error("Failed to remove from registry",l)}})};openCompetitorsModal=(o,e)=>{e.stopPropagation(),this.selectedEntry.set(o),this.showCompetitorsModal.set(!0),this.loadCompetitors(o.drug_id)};closeCompetitorsModal=()=>{this.showCompetitorsModal.set(!1),this.selectedEntry.set(null),this.competitors.set([])};loadCompetitors=o=>{this.loadingCompetitors.set(!0),this.registryService.getCompetitorsForDrug(o).subscribe({next:e=>{this.competitors.set(e),this.loadingCompetitors.set(!1)},error:e=>{console.error("Failed to load competitors",e),this.loadingCompetitors.set(!1)}})};formatPrice=o=>o===null?"N/A":`$${o.toFixed(2)}`;static \u0275fac=function(e){return new(e||i)(E(A))};static \u0275cmp=O({type:i,selectors:[["app-registry"]],standalone:!0,features:[F],decls:11,vars:3,consts:[[1,"page-header"],[1,"search-bar"],["type","text","placeholder","Search registry...",1,"search-input",3,"ngModelChange","ngModel"],[1,"loading"],[1,"empty-state"],[1,"modal-overlay"],["routerLink","/drugs"],[1,"table-container"],[1,"registry-table"],[3,"routerLink"],[1,"summary"],[1,"name-cell"],[1,"badge"],[1,"badge","dea"],[1,"actions-cell"],[1,"btn-competitors",3,"click"],[1,"btn-remove",3,"click"],[1,"modal-overlay",3,"click"],[1,"modal",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"drug-info"],[1,"modal-body"],[1,"modal-footer"],[1,"btn-secondary",3,"click"],[1,"generic"],[1,"competitors-table"],[1,"competitor-count"],[1,"competitor-name"],["target","_blank",1,"link",3,"href"]],template:function(e,l){e&1&&(t(0,"div",0)(1,"h1"),r(2,"Drug Registry"),n(),t(3,"p"),r(4,"Drugs you're tracking for potential sales or compounding"),n()(),t(5,"div",1)(6,"input",2),T("ngModelChange",function(_){return R(l.searchTerm,_)||(l.searchTerm=_),_}),n()(),g(7,U,2,0,"div",3)(8,q,3,1,"div",4)(9,K,23,2)(10,ae,15,2,"div",5)),e&2&&(a(6),k("ngModel",l.searchTerm),a(),m(l.loading()?7:l.filteredEntries().length===0?8:9),a(3),m(l.showCompetitorsModal()?10:-1))},dependencies:[z,j,D,N,$,L],styles:[".page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:600;color:#1a1a2e;margin:0 0 .5rem}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin:0}.search-bar[_ngcontent-%COMP%]{margin-bottom:1.5rem}.search-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:.75rem 1rem;font-size:1rem;border:1px solid #d1d5db;border-radius:6px;outline:none}.search-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{border-color:#4f46e5;box-shadow:0 0 0 3px #4f46e51a}.loading[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#6b7280}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem;background:#fff;border-radius:8px;box-shadow:0 1px 3px #0000001a}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin:.5rem 0}.empty-state[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#4f46e5;text-decoration:none}.empty-state[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.table-container[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 1px 3px #0000001a;overflow-x:auto}.registry-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.registry-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .registry-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.875rem 1rem;text-align:left;border-bottom:1px solid #e5e7eb}.registry-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f9fafb;font-weight:600;color:#374151;font-size:.875rem}.registry-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{cursor:pointer;transition:background .15s}.registry-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f9fafb}.registry-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.registry-table[_ngcontent-%COMP%]   .name-cell[_ngcontent-%COMP%]{font-weight:500;color:#1a1a2e}.registry-table[_ngcontent-%COMP%]   .actions-cell[_ngcontent-%COMP%]{white-space:nowrap}.badge[_ngcontent-%COMP%]{display:inline-block;padding:.25rem .5rem;font-size:.75rem;font-weight:500;border-radius:4px;margin-right:.25rem}.badge.rx[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.badge.otc[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.badge.dea[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.btn-competitors[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.8125rem;background:#4f46e5;color:#fff;border:none;border-radius:4px;cursor:pointer;margin-right:.5rem}.btn-competitors[_ngcontent-%COMP%]:hover{background:#4338ca}.btn-remove[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.8125rem;background:transparent;color:#dc2626;border:1px solid #dc2626;border-radius:4px;cursor:pointer}.btn-remove[_ngcontent-%COMP%]:hover{background:#fef2f2}.summary[_ngcontent-%COMP%]{margin-top:1rem;color:#6b7280;font-size:.875rem}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem}.modal[_ngcontent-%COMP%]{background:#fff;border-radius:12px;max-width:800px;width:100%;max-height:90vh;display:flex;flex-direction:column;box-shadow:0 20px 25px -5px #0000001a}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.25rem 1.5rem;border-bottom:1px solid #e5e7eb}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#1a1a2e;margin:0}.modal-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;color:#6b7280;cursor:pointer;padding:0;line-height:1}.modal-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{color:#1a1a2e}.drug-info[_ngcontent-%COMP%]{padding:1rem 1.5rem;background:#f9fafb;border-bottom:1px solid #e5e7eb}.drug-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#1a1a2e}.drug-info[_ngcontent-%COMP%]   .generic[_ngcontent-%COMP%]{color:#6b7280;margin-left:.5rem}.modal-body[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto;flex:1}.modal-body[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%], .modal-body[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{padding:2rem}.competitors-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.competitors-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .competitors-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem;text-align:left;border-bottom:1px solid #e5e7eb}.competitors-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f9fafb;font-weight:600;color:#374151;font-size:.8125rem}.competitors-table[_ngcontent-%COMP%]   .competitor-name[_ngcontent-%COMP%]{font-weight:500;color:#1a1a2e}.competitors-table[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{color:#4f46e5;text-decoration:none}.competitors-table[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]:hover{text-decoration:underline}.competitors-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.competitor-count[_ngcontent-%COMP%]{margin-top:1rem;color:#6b7280;font-size:.875rem;text-align:center}.modal-footer[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-top:1px solid #e5e7eb;display:flex;justify-content:flex-end}.btn-secondary[_ngcontent-%COMP%]{padding:.625rem 1.25rem;font-size:.875rem;background:#f3f4f6;color:#374151;border:1px solid #d1d5db;border-radius:6px;cursor:pointer}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e5e7eb}@media (max-width: 768px){.registry-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .registry-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.625rem .5rem;font-size:.875rem}.registry-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4), .registry-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4), .registry-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(5), .registry-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(5){display:none}.modal[_ngcontent-%COMP%]{max-height:100vh;border-radius:0}.competitors-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4), .competitors-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4){display:none}}"]})};export{W as RegistryComponent};
